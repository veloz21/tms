<b404-portlet>
  <b404-portlet-header [sticky]="true" [title]="getComponentTitle()" [class]="'b404-portlet__head--lg'"
    [viewLoading$]="loading$">
    <ng-container ktPortletTools>
      <a (click)="goBackWithoutId()" class="btn btn-secondary b404-margin-r-10" mat-raised-button
        matTooltip="{{'MODULE.GO_BACK' | b404Translate:translateParams}}">
        <i class="la la-arrow-left"></i>
        <span class="b404-hidden-mobile">{{"GENERAL.BUTTONS.BACK" | b404Translate}}</span>
      </a>
      <a href="javascript:;" class="btn btn-secondary b404-margin-r-10" (click)="reset()" [disabled]="selectedTab !== 0"
        mat-raised-button matTooltip="{{'GENERAL.BUTTONS.RESET_FORM' | b404Translate}}">
        <i class="la la-cog"></i>
        <span class="b404-hidden-mobile"> {{"GENERAL.BUTTONS.RESET" | b404Translate}} </span>
      </a>
      <a href="javascript:;" class="btn btn-primary b404-margin-r-10" color="primary" (click)="onSumbit(false)"
        mat-raised-button matTooltip="{{'GENERAL.BUTTONS.SAVE_FORM' | b404Translate}}">
        <span class="b404-hidden-mobile"> {{"GENERAL.BUTTONS.SAVE" | b404Translate}} </span>
      </a>
    </ng-container>
  </b404-portlet-header>
  <b404-portlet-body>
    <form [formGroup]="truckForm" class="b404-form b404-form--group-seperator-dashed" autocomplete="off">
      <mat-tab-group [(selectedIndex)]="selectedTab" *ngIf="truck">
        <mat-tab label="Basic info">
          <ng-template matTabContent>
            <div *ngIf="truck">
              <b404-alert *ngIf="hasFormErrors" type="warn" [showCloseButton]="true" [duration]="10000"
                (close)="onAlertClose($event)">
                <span> {{"GENERAL.TEXT.OH_SNAP_CREATE" | b404Translate}} </span>
              </b404-alert>
              <div class="b404-form__section b404-form__section--first">
                <div class="b404-form__group">
                  <div class="row">
                    <div class="col-md-4 b404-margin-bottom-10-mobile">
                      <mat-form-field appearance="outline" class="mat-form-field-fluid">
                        <mat-label>{{'WORKSHOP.TRUCK.MODEL.MODEL' | b404Translate}}</mat-label>
                        <input matInput placeholder="{{'WORKSHOP.TRUCK.MODEL.MODEL' | b404Translate }}"
                          formControlName="truckModel" required />
                        <mat-error>
                          {{'WORKSHOP.TRUCK.MODEL.MODEL' | b404Translate }}
                          <strong><span>{{"GENERAL.TEXT.REQUIRED" | b404Translate}}</span></strong>
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div class="col-md-4 b404-margin-bottom-10-mobile">
                      <mat-form-field appearance="outline" class="mat-form-field-fluid">
                        <mat-label>{{'WORKSHOP.TRUCK.MODEL.BRAND' | b404Translate}}</mat-label>
                        <input matInput placeholder="{{'WORKSHOP.TRUCK.MODEL.BRAND' | b404Translate }}"
                          formControlName="brand" required />
                        <mat-error>
                          {{'WORKSHOP.TRUCK.MODEL.BRAND' | b404Translate }}
                          <strong><span>{{"GENERAL.TEXT.REQUIRED" | b404Translate}}</span></strong>
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div class="col-md-4 b404-margin-bottom-10-mobile">
                      <mat-form-field appearance="outline" class="mat-form-field-fluid">
                        <mat-label>{{'WORKSHOP.TRUCK.MODEL.NICKNAME' | b404Translate}}</mat-label>
                        <input matInput placeholder="{{'WORKSHOP.TRUCK.MODEL.NICKNAME' | b404Translate }}"
                          formControlName="nickName" required />
                        <mat-error>
                          {{'WORKSHOP.TRUCK.MODEL.NICKNAME' | b404Translate }}
                          <strong><span>{{"GENERAL.TEXT.REQUIRED" | b404Translate}}</span></strong>
                        </mat-error>
                      </mat-form-field>
                    </div>

                  </div>
                </div>
                <div class="b404-form__group">
                  <div class="row">
                    <div class="col-md-4 b404-margin-bottom-10-mobile">
                      <mat-form-field appearance="outline" class="mat-form-field-fluid">
                        <mat-label>{{'WORKSHOP.TRUCK.MODEL.MOTOR_NUMBER' | b404Translate}}</mat-label>
                        <input matInput placeholder="{{'WORKSHOP.TRUCK.MODEL.MOTOR_NUMBER' | b404Translate }}"
                          formControlName="motorNumber" required />
                        <mat-error>
                          {{'WORKSHOP.TRUCK.MODEL.MOTOR_NUMBER' | b404Translate }}
                          <strong><span>{{"GENERAL.TEXT.REQUIRED" | b404Translate}}</span></strong>
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <!--New fields-->
                    <div class="col-md-4 b404-margin-bottom-10-mobile">
                      <mat-form-field appearance="outline" class="mat-form-field-fluid">
                        <mat-label>{{'WORKSHOP.TRUCK.MODEL.MAINTENANCE_PERIOD' | b404Translate}}</mat-label>
                        <input matInput placeholder="{{'WORKSHOP.TRUCK.MODEL.MAINTENANCE_PERIOD' | b404Translate }}"
                          formControlName="maintenancePeriod" required />
                        <mat-error>
                          {{'WORKSHOP.TRUCK.MODEL.MAINTENANCE_PERIOD' | b404Translate }}
                          <strong><span>{{"GENERAL.TEXT.REQUIRED" | b404Translate}}</span></strong>
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div class="col-md-4 b404-margin-bottom-10-mobile">
                      <mat-form-field appearance="outline" class="mat-form-field-fluid">
                        <mat-label>{{'WORKSHOP.TRUCK.MODEL.SERIAL_NUMBER' | b404Translate}}</mat-label>
                        <input matInput placeholder="{{'WORKSHOP.TRUCK.MODEL.SERIAL_NUMBER' | b404Translate }}"
                          formControlName="serialNumber" required />
                        <mat-error>
                          {{'WORKSHOP.TRUCK.MODEL.SERIAL_NUMBER' | b404Translate }}
                          <strong><span>{{"GENERAL.TEXT.REQUIRED" | b404Translate}}</span></strong>
                        </mat-error>
                      </mat-form-field>
                    </div>
                  </div>
                </div>
                <div class="b404-form__group">
                  <div class="row">
                    <div class="col-md-4 b404-margin-bottom-10-mobile">
                      <mat-form-field appearance="outline" class="mat-form-field-fluid">
                        <mat-label>{{'WORKSHOP.TRUCK.MODEL.INITIAL_RANGE' | b404Translate}}</mat-label>
                        <input matInput placeholder="{{'WORKSHOP.TRUCK.MODEL.INITIAL_RANGE' | b404Translate }}"
                          formControlName="initialRange" required type="number" />
                        <mat-error>
                          {{'WORKSHOP.TRUCK.MODEL.INITIAL_RANGE' | b404Translate }}
                          <strong><span>{{"GENERAL.TEXT.REQUIRED" | b404Translate}}</span></strong>
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div class="col-md-4 b404-margin-bottom-10-mobile">
                      <mat-form-field appearance="outline" class="mat-form-field-fluid">
                        <mat-label>{{'WORKSHOP.TRUCK.MODEL.RANGE_TRAVELED' | b404Translate}}</mat-label>
                        <input matInput placeholder="{{'WORKSHOP.TRUCK.MODEL.RANGE_TRAVELED' | b404Translate }}"
                          type="number" formControlName="rangeTraveled" required />
                        <mat-error>
                          {{'WORKSHOP.TRUCK.MODEL.RANGE_TRAVELED' | b404Translate }}
                          <strong><span>{{"GENERAL.TEXT.REQUIRED" | b404Translate}}</span></strong>
                        </mat-error>
                        <mat-error
                          *ngIf="truckForm.get('rangeTraveled').errors && truckForm.get('rangeTraveled').errors.TruckDistance">
                          <strong>La distancia viajada no puede ser menor que la inicial</strong>
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div class="col-md-4 b404-margin-bottom-10-mobile">
                      <mat-form-field appearance="outline" class="mat-form-field-fluid">
                        <mat-label>{{'WORKSHOP.TRUCK.MODEL.PRICE' | b404Translate}}</mat-label>
                        <span matPrefix>$ &nbsp;</span>
                        <input matInput matInputCurrency formControlName="price" type="text"
                          placeholder="{{'WORKSHOP.TRUCK.MODEL.PRICE' | b404Translate}}" />
                      </mat-form-field>
                    </div>
                  </div>
                </div>
                <div class="b404-form__group">
                  <div class="row">
                    <div class="col-md-4 b404-margin-bottom-10-mobile">
                      <label for="">{{'WORKSHOP.TRUCK.MODEL.TRUCK_PHOTOGRAPHY' | b404Translate}}</label><br>
                      <b404-file-drop [(file)]="imageFile" (fileChange)="setImageAsUrl($event)"></b404-file-drop>
                    </div>
                    <div *ngIf="imageUrl" class="col-md-4 b404-margin-bottom-10-mobile">
                      <img class="box" [src]="imageUrl">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ng-template>
        </mat-tab>
        <mat-tab label="Add tire">
          <ng-template matTabContent>
            <b404-tires-shared-edit [tiresFormArray]="truckForm.get('tires')" [tires]="truck.tires">
            </b404-tires-shared-edit>
          </ng-template>
        </mat-tab>
      </mat-tab-group>
    </form>
  </b404-portlet-body>
</b404-portlet>
